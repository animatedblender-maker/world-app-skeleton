import{a as N,b as z,c as R,d as V,e as W,f as D,j as L,k as U,m as F}from"./chunk-OOQ5NGO6.js";import{$ as s,B as o,Ba as T,E as m,F as P,J as f,M as E,N as c,O as r,P as a,Q as _,V as b,W as g,X as l,_ as v,aa as u,ba as k,da as C,ea as y,fa as w,ma as S,p as h,q as x,qa as O,u as M,ua as I,ya as A}from"./chunk-XHC7PKXJ.js";function j(n,t){if(n&1&&(r(0,"div",19),s(1),a()),n&2){let e=l();o(),u(e.errorMsg)}}function B(n,t){if(n&1&&(r(0,"div",24),s(1),a()),n&2){let e=l(2);o(),u(e.resetMsg)}}function q(n,t){if(n&1){let e=b();r(0,"div",20),s(1," Email already used. "),r(2,"div",21)(3,"button",22),g("click",function(){h(e);let d=l();return x(d.forgotPassword())}),s(4,"Forgot password"),a()(),f(5,B,2,1,"div",23),a()}if(n&2){let e=l();o(5),c("ngIf",e.resetMsg)}}function Y(n,t){if(n&1&&(r(0,"div",24),s(1),a()),n&2){let e=l(2);o(),u(e.resetMsg)}}function Z(n,t){if(n&1){let e=b();r(0,"div",20),s(1," Wrong password. "),r(2,"div",21)(3,"button",22),g("click",function(){h(e);let d=l();return x(d.forgotPassword())}),s(4,"Forgot password"),a()(),f(5,Y,2,1,"div",23),a()}if(n&2){let e=l();o(5),c("ngIf",e.resetMsg)}}function K(n,t){if(n&1&&(r(0,"div",24),s(1),a()),n&2){let e=l(2);o(),u(e.resetMsg)}}function J(n,t){if(n&1){let e=b();r(0,"div",20),s(1," Check your inbox to confirm your email, then come back and login. "),r(2,"div",21)(3,"button",22),g("click",function(){h(e);let d=l();return x(d.forgotPassword())}),s(4,"Forgot password"),a()(),f(5,K,2,1,"div",23),a()}if(n&2){let e=l();o(5),c("ngIf",e.resetMsg)}}function H(n,t){n&1&&(r(0,"div",20),s(1," If email confirmation is enabled, check your inbox to confirm. "),a())}var G=class n{constructor(t,e,i,d){this.auth=t;this.router=e;this.cdr=i;this.zone=d}tab="login";email="";password="";busy=!1;errorMsg="";accountExists=!1;needsEmailConfirm=!1;wrongPassword=!1;resetMsg="";forceUi(){this.zone.run(()=>this.cdr.detectChanges())}clearMsgs(){this.errorMsg="",this.accountExists=!1,this.needsEmailConfirm=!1,this.wrongPassword=!1,this.resetMsg=""}normalizeError(t){let e=t?.message??t?.error_description??t?.error?.message??t?.error?.error_description??t?.data?.message??t?.data?.error_description??"";if(e&&typeof e=="string")return e;try{return JSON.stringify(t)}catch{return String(t)}}isEmailExistsError(t){let e=(t||"").toLowerCase();return e.includes("already registered")||e.includes("already exists")||e.includes("already in use")||e.includes("email already")||e.includes("user_already_exists")||e.includes("email_exists")||e.includes("duplicate")||e.includes("exists")}isWrongPasswordError(t){let e=(t||"").toLowerCase();return e.includes("invalid login credentials")||e.includes("wrong password")||e.includes("invalid password")||e.includes("invalid credentials")}async forgotPassword(){this.resetMsg="",this.forceUi();try{let t=this.email.trim();if(!t){this.resetMsg="Type your email first.",this.forceUi();return}await this.auth.resetPassword(t),this.resetMsg="Reset email sent. Check your inbox."}catch(t){this.resetMsg=this.normalizeError(t)}finally{this.forceUi()}}async submit(){this.clearMsgs(),this.busy=!0,this.forceUi();try{let t=this.email.trim(),e=this.password;if(this.tab==="login"){await this.auth.login(t,e),await this.router.navigateByUrl("/");return}let i=await this.auth.register(t,e);if(i.isExistingEmail){this.accountExists=!0,this.errorMsg="Email already used.",this.tab="login";return}if(i.needsEmailConfirm){this.needsEmailConfirm=!0,this.tab="login";return}await this.router.navigateByUrl("/")}catch(t){let e=this.normalizeError(t);this.tab==="register"&&this.isEmailExistsError(e)?(this.accountExists=!0,this.errorMsg="Email already used.",this.tab="login"):this.tab==="login"&&this.isWrongPasswordError(e)?(this.wrongPassword=!0,this.errorMsg="Wrong password."):this.errorMsg=e}finally{this.busy=!1,this.forceUi()}}static \u0275fac=function(e){return new(e||n)(m(T),m(A),m(S),m(M))};static \u0275cmp=P({type:n,selectors:[["app-auth-page"]],decls:33,vars:14,consts:[[1,"auth-bg"],[1,"auth-frame"],[1,"scanlines"],[1,"grid"],[1,"auth-card"],[1,"auth-brand"],[1,"brand-mark"],[1,"brand-text"],[1,"brand-title"],[1,"brand-sub"],[1,"tabs"],["type","button",1,"tab",3,"click"],[1,"form",3,"ngSubmit"],[1,"field"],["type","email","name","email","autocomplete","email","placeholder","you@example.com","required","",3,"ngModelChange","ngModel"],["type","password","name","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","minlength","6","required","",3,"ngModelChange","ngModel"],["class","error",4,"ngIf"],["class","hint",4,"ngIf"],["type","submit",1,"cta",3,"disabled"],[1,"error"],[1,"hint"],[1,"actions"],["type","button",1,"link",3,"click"],["class","hint","style","margin-top:8px;",4,"ngIf"],[1,"hint",2,"margin-top","8px"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1),_(2,"div",2)(3,"div",3),r(4,"div",4)(5,"div",5),_(6,"div",6),r(7,"div",7)(8,"div",8),s(9,"WORLD APP"),a(),r(10,"div",9),s(11,"Authenticate to synchronize your node."),a()()(),r(12,"div",10)(13,"button",11),g("click",function(){return i.tab="login",i.clearMsgs()}),s(14," LOGIN "),a(),r(15,"button",11),g("click",function(){return i.tab="register",i.clearMsgs()}),s(16," REGISTER "),a()(),r(17,"form",12),g("ngSubmit",function(){return i.submit()}),r(18,"label",13)(19,"span"),s(20,"IDENTIFIER (EMAIL)"),a(),r(21,"input",14),w("ngModelChange",function(p){return y(i.email,p)||(i.email=p),p}),a()(),r(22,"label",13)(23,"span"),s(24,"ACCESS KEY (PASSWORD)"),a(),r(25,"input",15),w("ngModelChange",function(p){return y(i.password,p)||(i.password=p),p}),a()(),f(26,j,2,1,"div",16)(27,q,6,1,"div",17)(28,Z,6,1,"div",17)(29,J,6,1,"div",17),r(30,"button",18),s(31),a(),f(32,H,2,0,"div",17),a()()()()),e&2&&(o(13),v("active",i.tab==="login"),o(2),v("active",i.tab==="register"),o(6),C("ngModel",i.email),o(4),C("ngModel",i.password),E("autocomplete",i.tab==="register"?"new-password":"current-password"),o(),c("ngIf",i.errorMsg),o(),c("ngIf",i.accountExists),o(),c("ngIf",i.wrongPassword&&!i.accountExists),o(),c("ngIf",i.needsEmailConfirm&&!i.accountExists&&!i.wrongPassword),o(),c("disabled",i.busy),o(),k(" ",i.busy?"LINKING\u2026":i.tab==="login"?"LOGIN":"CREATE ACCOUNT"," "),o(),c("ngIf",i.tab==="register"))},dependencies:[I,O,F,D,N,z,R,L,U,W,V],styles:['[_nghost-%COMP%]{display:block;height:100vh}.auth-bg[_ngcontent-%COMP%]{height:100vh;display:grid;place-items:center;background:radial-gradient(1200px 800px at 50% 30%,rgba(0,255,209,.14),transparent 60%),radial-gradient(900px 700px at 60% 70%,rgba(140,0,255,.12),transparent 55%),#06080eeb}.auth-frame[_ngcontent-%COMP%]{position:relative;width:min(520px,92vw);padding:20px}.scanlines[_ngcontent-%COMP%]{pointer-events:none;position:absolute;inset:0;border-radius:26px;background:repeating-linear-gradient(to bottom,#ffffff0d 0px 1px,#0000 3px 6px);opacity:.35;mix-blend-mode:overlay;animation:_ngcontent-%COMP%_scan 7s linear infinite}@keyframes _ngcontent-%COMP%_scan{0%{transform:translateY(0)}to{transform:translateY(18px)}}.grid[_ngcontent-%COMP%]{pointer-events:none;position:absolute;inset:0;border-radius:26px;background-image:linear-gradient(rgba(0,255,209,.1) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,209,.08) 1px,transparent 1px);background-size:36px 36px;opacity:.25;-webkit-mask-image:radial-gradient(circle at 50% 45%,black 40%,transparent 75%);mask-image:radial-gradient(circle at 50% 45%,black 40%,transparent 75%)}.auth-card[_ngcontent-%COMP%]{position:relative;border-radius:26px;padding:18px;background:#0a0c1494;-webkit-backdrop-filter:blur(14px);backdrop-filter:blur(14px);box-shadow:0 30px 90px #00000073,0 0 0 1px #00ffd133,0 0 50px #00ffd11f;overflow:hidden}.auth-card[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;border-radius:28px;background:conic-gradient(from 180deg,#00ffd100,#00ffd1a6,#8c00ff8c,#00ffd100);filter:blur(10px);opacity:.45}.auth-card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;z-index:1}.auth-brand[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;margin-bottom:12px}.brand-mark[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;background:#00ffd1f2;box-shadow:0 0 18px #00ffd1a6}.brand-title[_ngcontent-%COMP%]{color:#ffffffeb;letter-spacing:.18em;font-weight:800;font-size:14px}.brand-sub[_ngcontent-%COMP%]{color:#ffffffad;font-size:12px;margin-top:2px}.tabs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:10px 0 14px}.tab[_ngcontent-%COMP%]{border:0;border-radius:16px;padding:12px;cursor:pointer;background:#ffffff0f;color:#ffffffc7;font-weight:800;letter-spacing:.12em}.tab.active[_ngcontent-%COMP%]{background:#00ffd124;color:#fffffff2;box-shadow:0 0 0 1px #00ffd140 inset,0 0 28px #00ffd11a}.form[_ngcontent-%COMP%]{display:grid;gap:12px}.field[_ngcontent-%COMP%]{display:grid;gap:7px}.field[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.14em;color:#ffffff9e}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:12px;background:#00000047;color:#ffffffeb;outline:none}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#00ffd159;box-shadow:0 0 0 3px #00ffd11a}.cta[_ngcontent-%COMP%]{border:0;border-radius:16px;padding:13px 14px;cursor:pointer;background:linear-gradient(90deg,#00ffd1d9,#8c00ffbf);color:#06080ef5;font-weight:900;letter-spacing:.18em;box-shadow:0 18px 50px #00ffd12e}.cta[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.error[_ngcontent-%COMP%]{color:#ff7878f2;background:#ff50501a;border:1px solid rgba(255,80,80,.18);padding:10px 12px;border-radius:16px;font-size:12px}.hint[_ngcontent-%COMP%]{color:#fff9;font-size:12px;line-height:1.4}.actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:6px;flex-wrap:wrap}.link[_ngcontent-%COMP%]{background:transparent;border:0;padding:0;cursor:pointer;color:#00ffd1eb;font-size:12px;letter-spacing:.08em;font-weight:800;text-decoration:underline}.link[_ngcontent-%COMP%]:hover{opacity:.85}']})};export{G as AuthPageComponent};
