import{Aa as r,k as l}from"./chunk-XHC7PKXJ.js";var d=class i{async uploadPostMedia(t){let a=(t.name.split(".").pop()||"bin").toLowerCase(),o=`posts/${crypto.randomUUID()}.${a}`,{error:e}=await r.storage.from("media").upload(o,t,{upsert:!1,cacheControl:"3600",contentType:t.type||"application/octet-stream"});if(e)throw e;let{data:n}=r.storage.from("media").getPublicUrl(o);return{path:o,publicUrl:n.publicUrl}}async uploadAvatar(t){let a=(t.name.split(".").pop()||"").toLowerCase();if(a==="gif"||t.type==="image/gif")throw new Error("GIF avatars are disabled for now. Please upload PNG/JPG/WebP.");let{data:o,error:e}=await r.auth.getSession();if(e)throw e;let n=o.session?.user?.id;if(!n)throw new Error("Not authenticated");let u=(a||"png").toLowerCase(),s=`${n}/${crypto.randomUUID()}.${u}`,{error:c}=await r.storage.from("avatars").upload(s,t,{upsert:!0,cacheControl:"3600",contentType:t.type||"image/png"});if(c)throw c;let{data:p,error:g}=await r.storage.from("avatars").createSignedUrl(s,3600*24*30);if(!g&&p?.signedUrl)return{path:s,url:p.signedUrl};let{data:m}=r.storage.from("avatars").getPublicUrl(s);return{path:s,url:m.publicUrl}}static \u0275fac=function(a){return new(a||i)};static \u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})};export{d as a};
