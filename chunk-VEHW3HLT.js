import{b as a,k as c}from"./chunk-SPQ2JWKS.js";import{a as l}from"./chunk-2NFLSA4Y.js";var d="worldapp.presenceOverrides.v1",u=class s{overrides$=new a(this.load());getOverrides(){return this.overrides$.value}observe(){return this.overrides$.asObservable()}setOverride(e,r){let t=String(e??"").trim().toUpperCase();if(!t)return;let n=l({},this.overrides$.value),i=this.normalizeOverride(r);i?n[t]=i:delete n[t],this.overrides$.next(n),this.save(n)}clearAll(){this.overrides$.next({}),this.save({})}normalizeCount(e){if(e==null||e==="")return null;let r=Number(e);return Number.isFinite(r)?Math.max(0,Math.floor(r)):null}normalizeOverride(e){if(!e)return null;let r=this.normalizeCount(e.total),t=this.normalizeCount(e.online);return r!==null&&t!==null&&t>r&&(t=r),r===null&&t===null?null:{total:r,online:t}}load(){try{let e=localStorage.getItem(d);if(!e)return{};let r=JSON.parse(e);if(!r||typeof r!="object")return{};let t={};for(let[n,i]of Object.entries(r)){let o=this.normalizeOverride(i);o&&(t[String(n).toUpperCase()]=o)}return t}catch{return{}}}save(e){try{localStorage.setItem(d,JSON.stringify(e))}catch{}}static \u0275fac=function(r){return new(r||s)};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};export{u as a};
